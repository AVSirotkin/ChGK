Данный репозиторий посвящен интеллектуальным играм и полезным штукам для них. Содержит 4 основных подпроекта.

* API - функции для работы с API турнироного сайта. Обертки над запросами, нужнные для других подпроектов.
* Rating - проект реализующий расчет рейтинга по модели описанной ниже.
* Site - проект сайта для выруализации рейтинга.
* Stats - набор утилит считающих различные статистические соотношения, на основе данных с турнирного сайта.

## Модель рейтинга ##

Данная модель основанна на модели [рейтинга Эло](https://ru.wikipedia.org/wiki/%D0%A0%D0%B5%D0%B9%D1%82%D0%B8%D0%BD%D0%B3_%D0%AD%D0%BB%D0%BE), однако ключевое отличие, это соревнование не команд друг с другом, а команд против вопросов.

Адаптируя рейтинг Эло, мы считаем что вероятность команда силы $S$ взять вопрос сложности $Q$ может быть оценена, как $$p(S,Q) = \frac{1}{1+10^{\frac{Q-S}{400}}}$$

Если мы знаем силу каждой команды, которая сыграла вопрос и знаем какие команды взяли вопрос, то мы можем расчипать вероятность подобного исхода как $\prod_i p(S_i,Q)$

Теперь пользуясь методом максимального правдоподобия, мы можем найти такое значение $Q$, при котором достигаемся максимальное значение $\prod_i p(S_i,Q)$.

Единственная важная оговорка, что если все команды возьмут вопрос, то сложность будет равна $-\infty$ (похожая ситуация, если не возьмет никто), чтобы этого избежать введем минимальную и максимальную сложность вопроса.

Таким образом мы для каждого вопроса научились вычислять его сложность.

Рассмотрм турнир из $n$ вопросов, в котором играли команды с силами $S_i$. Так как мы знаем, сколько команд взяли какой вопрос, то мы можем рассчитать сложность каждого вопроса.

Теперь для каждой команды можно вычислить матожидание числа взятых вопросов во всем турнире, как $\sum_j p(S_i, Q_j)$. Согласно идее рейтинга Эло, команды которые набрали больше прогноза, получают прибавку к рейтингу, а команды набравшие меньше прогноза -- штраф. На данный момент, величина прибавки/штрафа определяется как отклонение от прогноза умноженное на коэффициент равный 10 (подобран эмперически, но нужны еще эксперименты).

Если бы команды всегда играли в одинаковых составах, то описанная выше модель уже решала бы поставленную задачу, но это не так.
Так как за команду могут играть разные люди, то нужно научиться считать силу команды с заданным составом. 
В нашей модели, мы предполагаем, что для некоторой сложности вопроса (сейчас это 2000), его взятие происходит игроками независимо, и получается соотношение
$1-p(S,Q) = \prod_i (1-p(s_i, Q))$, где $s_i$ это силы игроков. То есть команда не возьмет сложный вопрос, если каждый из игроков не возьмет его. Понятно, что это не совсем точно, но пока это одно из лучших приближений. Из этого соотношения можно явно вывести формулу для силы команды.

Таким образом, для заданного набора игроков, мы можем вычислить силу команды состоящую из этих игроков. А сила команды из одного игрока, в точности соответствует силе этого игрока.
Экспериметны показали, что если изменить силу всех игроков одинаково, то примерно на столько же изменится и сила команды (это довольно грубое приближение, но оно позволяет сделать вычисления наглядными). А из описания выше, мы знаем как надо изменить силу команды, по результатам турнира. А значит если изменить силу каждого игрока на эту же величину, то это будет хорошее приближение.

Новые участники начинают с рейтингом 1000. Релизы игроков формируются по четвергам. Все турниры заканчивающиеся в течении недели от четверга до четверга, в качестве силы игроков используют результаты последнего релиза. Для каждого турнира расчитывается бонус/штраф для каждого игрока. Новый релиз учитывает все бонусы/штрафы игрока за неделю.

На данный момент модель запущена на всех рейтингуемых МАИИ турнирах начиная с 2 сентября 2021.


